<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>英文期中考考場、考試時間</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta property="og:description" content="Powered by MCUT Bot / Henry Wu">
	<meta property="og:image" content="https://mcut.henrywu.tw/res/logo.png">
	<link rel="icon" type="image/png" href="../res/logo.png">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocas-ui/2.3.2/tocas.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/6.4.5/swiper-bundle.min.css"/>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/6.4.5/swiper-bundle.min.js"></script>
	<script>
		$(function(){
			let dep = ["管設","環資","電機電子","機械"];
			let lev = ["初","中","高","菁英"];
			var sortById = function(a, b) {
				return ($(a).attr('data-sort') > $(b).attr('data-sort')) ? 1 : -1;
			}
			function getSortId(text) {
				return text.replace(' ','')
							.replace('管設',1)
							.replace('環資',2)
							.replace('電機電子',3)
							.replace('機械',4)
							.replace('初',1)
							.replace('中',2)
							.replace('高',3)
							.replace('菁英',4)
							.replace('A',1)
							.replace('B',2)
							.replace('C',3)
							.replace('D',4)
							.replace('E',5)
							.replace('F',6)
			}
			$.ajax({
				url: 'https://mcut.henrywu.tw/exam/data.json?v=20220315',
				dataType: 'json',
				success: function(res) {
					$('#menu,.filter,.swiper-container').show();
					$('#loading').remove();
					$.each(res, function(b, s) {
						h = '<div class="ts attached segment" data-sort="'+getSortId(s[0])+'">'+
							'<div class="ts header">'+s[0]+'<span>　'+s[1]+'</span></div>'+
							'<i class="user icon"></i>'+s[2]+'　<i class="marker icon"></i>'+s[5]+
						'</div>';
						if(s[1] == '生活與職場英文') {
							$('#s1').append(h);
							$('.date-1').html('<i class="clock icon"></i>'+s[3]+' '+s[4]);
						}
						else if(s[1] == '英語聽講') {
							$('#s2').append(h);
							$('.date-2').html('<i class="clock icon"></i>'+s[3]+' '+s[4]);
						}					
					});
					$('#s1 .segment').sort(sortById).appendTo('#s1');
					$('#s2 .segment').sort(sortById).appendTo('#s2');
					$('.swiper-scrollbar-outer').show();
					swiper.update();
				},
				error: function() {
					$('#loading').html('<div class="ts center aligned icon header"><i class="caution circle icon"></i>載入失敗<div class="sub header">讀取時發生錯誤，請稍後再試。</div></div>');
				}
			});
			$('.item').on('click',function(){
				$('html, body').animate({
					scrollTop: 0
				}, 500);
				updateFilter();
				$('#s3 .segment').show();
				swiper.slideTo(parseInt($(this).attr('data-id')));
			});
			$('.filter button').on('click',function(){
				c = $('[data-filter="'+$(this).attr('data-filter')+'"]').hasClass('active');
				if($(this).parent().hasClass('a')) $('.a.buttons .button').removeClass('active');
				if($(this).parent().hasClass('b')) $('.b.buttons .button').removeClass('active');
				if(!c) $('[data-filter="'+$(this).attr('data-filter')+'"]').addClass('active');
				updateFilter();
				$('#s3 .segment').show();
			});
			function updateFilter() {
				dep = [];
				lev = [];
				$('.filter .a button.active').each(function(){
					dep.push($(this).text());
				});
				$('.filter .b button.active').each(function(){
					lev.push($(this).attr('data-filter'));
				});
				if(dep.length == 0) dep = ["管設","環資","電機電子AI","機械"];
				if(lev.length == 0) lev = ["初","中","高","菁英"];
				$('.swiper-slide .segment:not(.filter)').hide();
				$('.swiper-slide .segment:not(.filter)').each(function(){
					el = $(this);
					t = $(this).find('.header').text();
					$.each(dep, function(i,j) {
						$.each(lev, function(ii,k) {
							if(t.includes(j) && t.includes(k)) el.show();
						});
					});
				});
				swiper.update();
			}
			var swiper = new Swiper('.swiper-container', {
				scrollbar: {el: '.swiper-scrollbar'},
				autoHeight: true
			});
			if (navigator.share) { $('#share').show(); }
			$('#share a').on('click', function() {
				navigator.share({
					title: '明志科大英文段考考場、考試時間',
					text: '',
					url: 'https://mcut.henrywu.tw/exam',
				}).then(() => console.log('Successful share'))
				.catch((error) => console.log('Error sharing', error));
			});
		});
	</script>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-DZHZ6VYR7M"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-DZHZ6VYR7M');
	</script>
	<style>
		.swiper-slide span {
			display:none
		}
		
		a {
			color:#e74c3c;
			text-decoration:none
		}
		
		a:hover,
		a:active {
			color:#c0392b;
			text-decoration:none
		}

		#menu .item {
			border-bottom: none
		}

		#menu .item:hover:before {
			background:rgb(244, 244, 244)
		}

		.swiper-slide {
			min-height: calc(100vh - 73px)
		}

		.swiper-scrollbar-outer {
			top:0;
			z-index:10000;
			position: fixed;
			width:600px;
			max-width:100%;
			margin: 43px auto 0;
			display: none
		}

		.swiper-scrollbar {
			width: 100%;
			height: 2px
		}
		
		.date {
			font-size: 120%;
			padding: 5px 0
		}

		.ts.button:not(.visible):not(.hidden):not(.active):not(:active):not(.opinion):hover {
			background-color: #eee !important
		}

		#loading {
			padding: 40vh 0 38vh;
		}
	</style>
</head>
<body>
	<div id="main" style="width:600px;max-width:100%;margin:43px auto 30px">
		<div id="menu" class="ts large pointing secondary evenly divided top fixed menu" style="width:600px;max-width:100%;margin:0 auto;background:#F4F4F4;display:none;border-bottom-color:rgb(244, 244, 244)">
			<a data-id="0" class="item">大一生活與職場英文</a>
			<a data-id="1" class="item">大二英語聽講</a>
		</div>
		<div id="loading">
			<div class="ts active inverted dimmer">
				<div class="ts text loader">讀取中</div>
			</div>
			<br><br><br><br>
		</div>
		<div class="swiper-container" style="display:none;">
			<div class="swiper-scrollbar-outer">
				<div class="swiper-scrollbar"></div>
			</div>
			<div class="swiper-wrapper">
				<div id="s1" class="swiper-slide">
					<div data-sort="0" class="filter ts secondary segment attached" style="text-align:center;padding-top:8px;padding-bottom:8px;display:none">
						<div class="date date-1"></div>
						<div class="a ts small very compact buttons" style="margin:5px 0;">
							<button class="ts button" data-filter="管設">管設</button>
							<button class="ts button" data-filter="環資">環資</button>
							<button class="ts button" data-filter="電機電子AI">電機電子 AI</button>
							<button class="ts button" data-filter="機械">機械</button>
						</div>
						<div style="display:block">
							<div class="b ts small very compact buttons">
								<button class="ts button" data-filter="初">初級</button>
								<button class="ts button" data-filter="中">中級</button>
								<button class="ts button high"  data-filter="高">高級</button>
								<button class="ts button legend"  data-filter="菁英">菁英</button>
							</div>
						</div>
					</div>
				</div>
				<div id="s2" class="swiper-slide">
					<div data-sort="0" class="filter ts secondary segment attached" style="text-align:center;padding-top:8px;padding-bottom:8px;display:none">
						<div class="date date-2"></div>
						<div class="a ts small very compact buttons" style="margin:5px 0;">
							<button class="ts button" data-filter="工管經管視傳行設">工管經管視傳行設</button>
							<button class="ts button" data-filter="環資">環資</button>
							<button class="ts button" data-filter="電機電子AI">電機電子</button>
							<button class="ts button" data-filter="機械工設">機械工設</button>
						</div>
						<div style="display:block">
							<div class="b ts small very compact buttons">
								<button class="ts button" data-filter="初">初級</button>
								<button class="ts button" data-filter="中">中級</button>
								<button class="ts button high"  data-filter="高">高級</button>
								<button class="ts button legend"  data-filter="菁英">菁英</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<footer style="position:fixed;z-index:10000;width:100%;padding:5px;bottom:0;background:#FFF;text-align:center;box-shadow:0 0 5px 5px rgba(0,0,0,.05)">
		<div style="width:600px;max-width:100%;margin:0 auto">
			Powered by <a href="https://line.me/R/ti/p/%40ptq1966v" target="_blank">MCUT Bot</a> / <a href="https://henrywu.tw" target="_blank">Henry Wu</a><span id="share" style="display:none">・<a>分享</a></span>
		</div>
	</footer>
</body>
</html>
